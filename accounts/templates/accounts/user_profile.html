{% extends "main.html" %}

{% load static %}

{% load filters %}

{% load compress %}

{% block main %}

<div class="flex w-full h-full gap-[6vh] p-[2vh] text-white justify-center">
  {% include 'navbar.html' %}

  <div class="main-content flex-1 flex flex-col gap-[1vh] m-[2vh]">
    <div
      class="heading flex flex-col md:flex-row gap-[2vh] mb-[2vh] md:gap-[1.5vh] items-center justify-center">
      <div class="flex gap-[1.5vh]">
        <div
          class="profile-pic aspect-square h-[12vh] md:h-[25vh] rounded-full overflow-hidden">
          
            <img src="https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=387&q=80" alt="Profile Picture" class="object-cover w-full h-full">
         

          <!-- <div class="w-[16vh] h-[16vh]">
            {% if grid %}
              <div class="grid grid-cols-6 gap-1 h-full">
                {% for row in grid.data|slice:":36"|make_list|chunk:6 %}
                  {% for cell in row %}
                    <div class="text-white flex justify-center items-center">
                      {% if cell == '1' %}
                        <div class="h-[1.75vh] w-[1.75vh] rounded-full text-white bg-white"></div>
                      {% endif %}
                    </div>
                  {% endfor %}
                {% endfor %}
              </div>
            {% else %}
                <p class="text-white">No grid data available.</p>
            {% endif %}
          </div> -->
        </div>
        <div
          class="p-[2vw] flex flex-col gap-[1vh] md:gap-[2vh] flex-1 justify-center">
          <p class="text-2xl lg:text-5xl md:text-4xl font-semibold">
            {{ user.first_name }} {{ user.last_name }}
          </p>
          <p
            class="text-sm mx-[1vh] md:mx-[3vh] text-neutral-400 underline font-semibold">
            {{ user.email }}
          </p>
          <p class="hidden md:block lg:text-xl md:text-regular mx-[3vh]">
            {% if user.bio %}
              {{ user.bio|truncatechars:100 }}
            {% endif %}
          </p>
        </div>
      </div>
      <p class="md:hidden text-center text-sm mx-[3vh]">
        {% if user.bio %}
          {{ user.bio|truncatechars:90 }}
        {% endif %}
      </p>
      <div
        class="flex gap-[8vw] md:gap-[1.5vh] w-full md:w-max font-medium">
        <div
          class="flex-1 md:m-[2vh] lg:m-[5vh] flex flex-col items-center justify-center">
          <p class="font-bold text-2xl md:text-4xl lg:text-5xl">{{ assist_count }}</p>
          <p class="text-sm md:text-regular lg:text-xl text-center">
            Assists
          </p>
        </div>
        <div
          class="flex-1 md:m-[2vh] lg:m-[5vh] flex flex-col items-center justify-center">
          <p class="font-bold text-2xl md:text-4xl lg:text-5xl">{{ upvote_count }}</p>
          <p class="text-sm md:text-regular lg:text-xl text-center">
            Helped
          </p>
        </div>
      </div>
    </div>
    <div
      class="flex items-navbar place-self-center gap-[4vw] font-semibold text-xs md:text-lg w-full items-center justify-center text-center">
      <a href="?tab=decisions" 
        class="flex-1 md:flex-none text-neutral-400 tab-link {% if selected_tab == 'decisions' %} text-white flex flex-col items-center justify-center {% endif %}" data-tab="decisions">Decisions
        {% if selected_tab == 'decisions' %}
          <div
            class="h-[0.4vh] rounded-full w-[3vw] m-[0.5vh] lg:w-[1vw] bg-white"></div>
        {% endif %}
      </a>
      <a href="?tab=assists"
        class="flex-1 md:flex-none text-neutral-400 tab-link {% if selected_tab == 'assists' %} text-white flex flex-col items-center justify-center {% endif %}" data-tab="assists">Assists
        {% if selected_tab == 'assists' %}
          <div
            class="h-[0.4vh] rounded-full w-[3vw] m-[0.5vh] lg:w-[1vw] bg-white"></div>
        {% endif %}
      </a>
      <a href="?tab=saved" 
        class="flex-1 md:flex-none text-neutral-400 tab-link {% if selected_tab == 'saved' %} text-white flex flex-col items-center justify-center {% endif %}" data-tab="saved">Saved
        {% if selected_tab == 'saved' %}
          <div
            class="h-[0.4vh] rounded-full w-[3vw] m-[0.5vh] lg:w-[1vw] bg-white"></div>
        {% endif %}
      </a>
    </div>
    <!-- decisions -->
    {% if selected_tab == 'decisions' %}
      <div
        class="items overflow-y-scroll md:p-[1vh] grid md:grid-cols-3 place-self-center w-full lg:grid-cols-4 gap-[1.5vw] flex-1 tab-content" id="decisions">
        {% for decision in data %}
          <a href="{% url 'public-decision' decision.id %}">
            <div
              class="decision flex flex-col p-[2vh] lg:p-[2vh] text-center md:items-center text-xl md:text-3xl lg:text-[2rem] md:leading-snug lg:leading-tight font-semibold rounded-[3vh] md:rounded-[4vh] h-[18vh] md:h-[45vh]">
              <div class="flex-1 flex items-center justify-center">
                {{ decision.title }}
              </div>
              <div
                class="uppercase text-white text-base self-end place-self-end lg:px-[1vw]">
                1221
                <p class="hidden md:inline-block">Assists</p>
              </div>
              <div
                class="hidden lg:block opacity-0 m-[1vh] on-hover-line h-[1vh] rounded-full w-[50%]"></div>
            </div>
          </a>
        {% empty %}
            <p>No recent decisions.</p>
        {% endfor %}
      </div>
    <!-- assists -->
    {% elif selected_tab == 'assists' %}
      <div
        class="items overflow-y-scroll md:p-[1vh] grid md:grid-cols-3 place-self-center w-full lg:grid-cols-4 gap-[1.5vw] flex-1 tab-content" id="assists">
        {% for assist in data %}
          <a href="{% url 'public-decision' assist.decision.id %}" class="text-blue-500 hover:underline">
            <div
              class="decision flex flex-col p-[3vh] lg:p-[2vh] md:items-center text-2xl md:text-4xl lg:text-[2rem] md:leading-snug lg:leading-tight font-semibold rounded-[3vh] md:rounded-[4vh] h-[18vh] md:h-[45vh]">
              <div class="flex-1 flex text-center items-center">
                {{ assist.decision.title }}
              </div>
              <div
                class="uppercase text-white text-base self-end place-self-end lg:px-[1vw]">
                1221
                <p class="hidden md:inline-block">Assists</p>
              </div>
              <div
                class="hidden lg:block opacity-0 m-[1vh] on-hover-line h-[1vh] rounded-full w-[50%]"></div>
            </div>
          </a>
        {% empty %}
            <p>No recent assists.</p>
        {% endfor %}    
      </div>
    <!-- saved -->
    {% elif selected_tab == 'saved' %}
      <div
        class="items overflow-y-scroll md:p-[1vh] grid md:grid-cols-3 place-self-center w-full lg:grid-cols-4 gap-[1.5vw] flex-1 tab-content" id="saved">
        {% for assist in data %}
          <a href="{% url 'public-decision' assist.decision.id %}" class="text-blue-500 hover:underline">
            <div
              class="decision flex flex-col p-[3vh] lg:p-[2vh] md:items-center text-2xl md:text-4xl lg:text-[2rem] md:leading-snug lg:leading-tight font-semibold rounded-[3vh] md:rounded-[4vh] h-[18vh] md:h-[45vh]">
              <div class="flex-1 flex text-center items-center">
                {{ assist.message|truncatechars:30 }}
              </div>
              <div
                class="uppercase text-white text-base self-end place-self-end lg:px-[1vw]">
                31
                <p class="hidden md:inline-block">Upvotes</p>
              </div>
              <div
                class="hidden lg:block opacity-0 m-[1vh] on-hover-line h-[1vh] rounded-full w-[50%]"></div>
            </div>
          </a>
        {% empty %}
            <p>No upvoted assists.</p>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>

{% endblock main %}